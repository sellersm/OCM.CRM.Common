<QueryViewSpec
	xmlns="bb_appfx_queryview"
	xmlns:common="bb_appfx_commontypes" 
	ID="a3de7e91-1533-4fc3-987b-494d655c074c"
	Name="Rate Increase Implementation Log Query"
	Description="Used to display / query the log for the rate increase implementation scripts"
	Author="Caru Mayeda"
	IsRoot="true"
	PrimaryKeyField="REVENUEID"
	RecordType="REVENUE"
	common:SecurityUIFolder="Rate Increase"
	>
	<!-- 
	Remarks:    

	History:
	Date            Modified By     Comments
	02-Apr-2013		CMayeda			Initial Version
	-->
	<!-- define the view used to return data for the query -->
	<ViewImplementation ViewName="USR_V_QUERY_RATEINCREASE_IMPLEMENTATIONLOG">
		<ViewSQL>
			<![CDATA[
select 
	log.REVENUEID,
	log.SESSIONID,
	log.IMPLMENTATIONDATE,
	log.LOGMESSAGE,
	log.GIFTAMOUNT,
	log.RECORDCOMPLETED,
	log.DATEADDED,
	log.DATECHANGED,
	log.ADDEDBYID,
	log.CHANGEDBYID,
	addedby.APPLICATIONNAME as ADDEDBY_APPLICATION,
	addedby.USERNAME as ADDEDBY_USERNAME,
	changedby.APPLICATIONNAME as CHANGEDBY_APPLICATION,
	changedby.USERNAME as CHANGEDBY_USERNAME	
	
from 
	dbo.USR_RATECHANGE_IMPLEMENTATION_LOGPROCESS log
	left join dbo.CHANGEAGENT addedby on addedby.ID = log.ADDEDBYID
	left join dbo.CHANGEAGENT changedby on changedby.ID = log.CHANGEDBYID

			]]>
		</ViewSQL>
	</ViewImplementation>

	<!-- describe each field in the view output -->
	<Output>
		<OutputFields>
			<OutputField Caption="System record ID" Category="System Fields" Name="REVENUEID" DataType="Guid"/>
			<OutputField Name="SESSIONID" Caption="Session ID" DataType="Guid" />
			<OutputField Name="IMPLMENTATIONDATE" Caption="Implementation Date" DataType="Date" />
			<OutputField Name="LOGMESSAGE" Caption="Log Message" DataType="String" />
			<OutputField Name="GIFTAMOUNT" Caption="Gift Amount" DataType="Money" />
			<OutputField Name="RECORDCOMPLETED" Caption ="Record Completed" DataType="Boolean" />
			<OutputField Caption="Date added" Category="System Fields" Name="DATEADDED" CaptionResourceKey="$$date_added" CategoryResourceKey="$$system_fields" />
			<OutputField Caption="Date changed" Category="System Fields" Name="DATECHANGED" CaptionResourceKey="$$date_changed" CategoryResourceKey="$$system_fields" />
			<OutputField Caption="Added by application" Category="System Fields" Name="ADDEDBY_APPLICATION" CaptionResourceKey="$$added_by_application" CategoryResourceKey="$$system_fields">
				<LookupInfo>
					<SimpleDataList SimpleDataListID="37E3E458-AF0D-4dbc-8A18-A93885521A42" />
				</LookupInfo>
			</OutputField>
			<OutputField Caption="Added by user name" Category="System Fields" Name="ADDEDBY_USERNAME" CaptionResourceKey="$$added_by_user_name" CategoryResourceKey="$$system_fields">
				<LookupInfo>
					<SimpleDataList SimpleDataListID="CEA15E1C-E455-41be-9ECF-6B5453FA96A4" />
				</LookupInfo>
			</OutputField>
			<OutputField Caption="Changed by application" Category="System Fields" Name="CHANGEDBY_APPLICATION" CaptionResourceKey="$$changed_by_application" CategoryResourceKey="$$system_fields">
				<LookupInfo>
					<SimpleDataList SimpleDataListID="37E3E458-AF0D-4dbc-8A18-A93885521A42" />
				</LookupInfo>
			</OutputField>
			<OutputField Caption="Changed by user name" Category="System Fields" Name="CHANGEDBY_USERNAME" CaptionResourceKey="$$changed_by_user_name" CategoryResourceKey="$$system_fields">
				<LookupInfo>
					<SimpleDataList SimpleDataListID="CEA15E1C-E455-41be-9ECF-6B5453FA96A4" />
				</LookupInfo>
			</OutputField>

		</OutputFields>
	</Output>

	<RelationshipOperations>
		<AddRelatedView RelatedView="V_QUERY_REVENUE" RelatedField="ID" Field="REVENUEID" PathAlias="Revenue"/>	
	</RelationshipOperations>
</QueryViewSpec>

